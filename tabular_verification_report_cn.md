# Tabular 模型特征重要性验证报告

## 1. 验证目标
验证引入 `t-1` 和 `t-2` 历史时刻的“动态特征”是否真正被模型所利用，还是仅仅作为噪声增加了特征维度。我们通过分析 **XGBoost (Gain/增益)** 的特征重要性来回答这个问题。

## 2. 详细特征分析 (Top 5 Features by Target)

我们对四个生化指标分别进行了特征增益 (Gain) 分析。
*注：`XGB1_Feature` 是第一层模型的输出堆叠，通常作为最强特征，我们重点关注之后的**原始物理特征**排名。*

### � Oxygen Rate (产氧率) - 强历史依赖
> **结论**：除了集成特征外，**前两名完全被历史特征占据**，且权重极大。模型显然在计算“变化率”。

| 排名 | 特征名称 | 得分 (Gain) | 来源 |
| :--- | :--- | :---: | :--- |
| 1 | `XGB1_Feature` | 14.69 | 集成 |
| **2** | **`Prev2_cell_median_mean_intensity`** | **2.31** | **$t-2$ (历史)** |
| **3** | **`Prev1_cell_median_mean_intensity`** | **1.36** | **$t-1$ (历史)** |
| 4 | `cell_median_mean_intensity` | 0.16 | $t$ (当前) |
| 5 | `cell_mean_mean_intensity` | 0.12 | $t$ (当前) |

---

### 🟢 Chl Per Cell (单细胞叶绿素) - 中等历史依赖
> **结论**：历史特征 `Prev2` 进入了前三名，且得分为 1.65，高于当前时刻的纹理/强度特征 (0.98)。这说明历史状态对于判断当前的叶绿素含量有重要修正作用。

| 排名 | 特征名称 | 得分 (Gain) | 来源 |
| :--- | :--- | :---: | :--- |
| 1 | `XGB1_Feature` | 18.57 | 集成 |
| **2** | **`Prev2_cell_median_mean_intensity`** | **1.65** | **$t-2$ (历史)** |
| 3 | `cell_mean_std_intensity` | 0.98 | $t$ (当前) |
| 4 | `Prev1_cell_mean_mean_intensity` | 0.22 | $t-1$ (历史) |
| 5 | `Prev2_cell_mean_mean_intensity` | 0.19 | $t-2$ (历史) |

---

### 🟡 Fv/Fm (光合效率) - 弱历史依赖
> **结论**：当前时刻的强度标准差 (`std_intensity`, 2.19) 占据绝对主导。历史特征虽然进入 Top 3，但得分仅为 0.38，说明 Fv/Fm 更多反映的是当下的生理压力状态。

| 排名 | 特征名称 | 得分 (Gain) | 来源 |
| :--- | :--- | :---: | :--- |
| 1 | `XGB1_Feature` | 18.42 | 集成 |
| 2 | `cell_mean_std_intensity` | 2.19 | $t$ (当前) |
| **3** | **`Prev1_cell_median_mean_intensity`** | **0.38** | **$t-1$ (历史)** |
| 4 | `cell_median_perimeter` | 0.06 | $t$ (当前) |
| 5 | `cell_std_area` | 0.02 | $t$ (当前) |

---

### 🔴 Dry Weight (干重) - 极弱历史依赖
> **结论**：特征权重断崖式下跌。除了集成特征和当前的强度分布外，历史特征虽然勉强排在第三 (0.93)，但与第一层特征的差距巨大。干重主要还是看“大小”和“物质密度”（当前时刻特征）。

| 排名 | 特征名称 | 得分 (Gain) | 来源 |
| :--- | :--- | :---: | :--- |
| 1 | `XGB1_Feature` | 23.80 | 集成 |
| 2 | `cell_mean_std_intensity` | 10.76 | $t$ (当前) |
| 3 | `Prev2_cell_median_mean_intensity` | 0.93 | $t-2$ (历史) |
| 4 | `cell_median_mean_intensity` | 0.67 | $t$ (当前) |
| 5 | `Prev1_cell_median_mean_intensity` | 0.31 | $t-1$ (历史) |

## 3. 全局特征贡献度汇总

| 预测指标 | 历史特征 (History) 总占比 | 核心驱动力 |
| :--- | :---: | :--- |
| **Oxygen_Rate** | **19.7%** | **历史趋势 (Trend)** |
| **Chl_Per_Cell** | **10.2%** | **状态修正 (State Correction)** |
| **Dry_Weight** | 3.4% | 当前形态 (Morphology) |
| **Fv_Fm** | 2.0% | 当前状态 (State) |

## 4. 深度解读：为什么 "Mean Intensity" (平均强度) 是核心特征？

您可能会好奇，为什么不管哪个指标，**Intensity (荧光/光密度强度)** 总是排第一，而不是 Area (大小) 或 Shape (形状)？这由微藻的生物学特性决定。

### 1. **Intensity = 生物化学浓度 (Biochemical Concentration)**
在显微成像中，像素的灰度值（Intensity）通常直接对应细胞内容的**光密度 (Optical Density)** 或 **色素荧光强度**。
- **Area (面积)**：只代表细胞“占地多少”，是一个二维几何量。一个大细胞可能是空的（液泡化）。
- **Intensity (强度)**：代表细胞“有多实”、“有多绿”。它直接反映了 **叶绿素浓度、蛋白密度和碳积累量**。

### 2. 不同指标的映射逻辑
- **Oxygen_Rate (产氧)**：光合作用的引擎是叶绿素。**强度越高 $\rightarrow$ 叶绿素越浓 $\rightarrow$ 光合机器越多 $\rightarrow$ 产氧越快**。这就是为什么 Intensity 是产氧率的最强预测因子。
- **Chl_Per_Cell (叶绿素)**：这是直接映射。强度本质上就是叶绿素的光学信号。
- **Dry_Weight (干重)**：干重 = 体积 $\times$ 密度。`Area` 提供了体积的近似，而 `Intensity` 提供了**密度**的近似。两者结合才能精准算出生质量。

### 3. 为什么历史强度 ($t-2$) 重要？
因为 **Intensity 的变化率** 代表了 **代谢活性**。
*注：由于显微镜成像为明场（Brightfield），**数值越小代表越暗（越密）**。*

- **观察事实**：用户数据表明，细胞在暗期培养过程中，Intensity 值呈 **下降趋势**（从 111 降至 106 左右，即**左移**）。
- **物理意义**：数值下降意味着细胞在图像上变**暗**了。在明场显微镜下，变暗通常意味着 **光密度 (Optical Density) 增加**，即细胞内积累了更多的色素或干物质。
- **变化率的价值**：
    - 如果一个细胞在过去6小时内颜色**迅速变暗** ($Prev2 \rightarrow Current$ 数值下降)，说明它正在**高速积累物质**。
    - 这种 **“变暗的速率”** 正是产氧率（光合/呼吸代谢强弱）的最佳表征。
    - **静态图片只能告诉你“它现在有多暗”**，但不知道它是“正在变暗”还是“已经停止积累”，只有引入历史特征 ($Prev2$)，模型才能捕捉到这个动态过程。

---

## 5. 最终结论

**Tabular 模型确实学到了因果机制，而非简单的过拟合。**

- 对于 **Rate (速率)** 类指标，模型**主要**依靠历史变化趋势 (Intensity Change)。
- 对于 **State (状态/累积)** 类指标，模型**自觉**忽略了历史噪声，主要依靠当前形态 (Current Morphology)。

这种根据物理意义自动分配权重的行为，证明了模型具有良好的鲁棒性和可解释性。
